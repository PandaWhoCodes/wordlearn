<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"  crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='css/chat_interface.css')}}">
    <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='css/article.css')}}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Josefin+Sans:300|Open+Sans:300|Oxygen|Material+Icons" rel="stylesheet">
	<title>Word Scramble</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>

<body>
    <div class="container">
    <!-- <br/> -->
    <div class="row" style="padding-block-start: 30px;">
      <div class="col-md-2"></div>
        <div class="col-md-8" style="" class="chat_div">
            <div class="chat_window">
                <div class="top_menu">
                    <div class="logo"></div>
                    <div class="head">
                        <div class="title" id="title">Word Scramble</div>
                        <div class="tag_line" id="tag_line"> A game to improve your vocabulary</div>
                    </div>
                    <div class="help" > <a class="trigger_popup_fricc" > Help </a> </div>
                    <div class="hover_bkgr_fricc">
                      <span class="helper"></span>
                      <div>
                          <div class="popupCloseButton">&times;</div>
                          <p>You have received a scrambled word<br />Guess the words from the given letters and gain score</p>
                      </div>
                  </div>
                </div>
                <div class="displaywrapper">
                    <div class="validinvalid">
                        <div class="validinvalid_words" id="valid">
                            <div>Valid words</div>
                            <ul class='validinvalid_list' id="valid_list"></ul>
                        </div>
                        <div class="validinvalid_words" id="invalid">
                            <div>Invalid words</div>
                            <ul class='validinvalid_list' id='invalid_list'></ul>
                        </div>
                    </div>
                    <div class="worddisplay" id="worddisplay">
                        <div class="buttondisplay"><br><br> </div>
                        <div class="buttondisplay">
                            <input type="button" onclick="firstletter();" class="wordbutton" id="0">
                        </div>
                        <div class="buttondisplay"></div>
                        <div class="buttondisplay">
                            <input type="button" onclick="secondletter();" class="wordbutton" id="5">
                        </div><br>
                        <div class="buttondisplay"></div>
                        <div class="buttondisplay">
                            <input type="button" onclick="thirdletter();" class="wordbutton" id="1">
                        </div>
                        <div class="buttondisplay">&nbsp&nbsp&nbsp&nbsp</div>
                        <div class="buttondisplay" id='score'>0</div>
                        <div class="buttondisplay">&nbsp&nbsp&nbsp&nbsp</div>
                        <div class="buttondisplay">
                            <input type="button" onclick="fourthletter();" class="wordbutton" id="4">
                        </div><br>
                        <div class="buttondisplay"></div>
                        <div class="buttondisplay">
                            <input type="button" onclick="fiffthletter();" class="wordbutton" id="2">
                        </div>
                        <div class="buttondisplay"></div>
                        <div class="buttondisplay">
                            <input type="button" onclick="sixthletter();" class="wordbutton" id="3">
                        </div>
                        
                        
                        
                    </div>
                    <div class='Scrambledword'><br>Scrambled Word</div>
                    
                  </div>
                <div class="bottom_wrapper clearfix">
                    <div class="message_input_wrapper">
                        <div id="word_entered" class="word_entered"></div> 
                    </div>
                    <div class="control_buttons">
                      <div class="command_button" id="command_button">
                        <button id="start" type="button" class="btn btn-success" style="color: black" onclick="new_button();">New</button>
                      </div>
                      
                      <div class="command_button" id="command_button">
                        <button id="start" type="button" class="btn btn-success" style="color: black" onclick="clear_button();">Clear</button>
                      </div>
                      <div class="command_button" id="command_button">
                        <button id="start" type="button" class="btn btn-success" style="color: black" onclick="shuffle_button();">Shuffle</button>
                      </div>
                      <div class="command_button" id="command_button">
                        <button id="start" type="button" class="btn btn-success" style="color: black" onclick="enter_button();">Enter</button>
                      </div>
                    </div>
                </div>
                
            </div>
            
        </div>
        <div class="col-md-2"></div>
  </div>
</body>

<footer>
</footer>
<script src="{{url_for('static',filename='js/main.js')}}"></script>
<script src="{{url_for('static',filename='js/circle.js')}}"></script>

  <script type="text/javascript">
//   get_old_conversation();
//   set_title();

window.onload = function start(){
  button_controls('/start');
  $(".trigger_popup_fricc").click(function(){
       $('.hover_bkgr_fricc').show();
    });
  $('.hover_bkgr_fricc').click(function(){
      $('.hover_bkgr_fricc').hide();
    });
  $('.popupCloseButton').click(function(){
      $('.hover_bkgr_fricc').hide();
    });
}

var sp = "";
if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
    $("#send_button").hide();
//    $(".message_input_wrapper").append('<span id="sp" style="font-size: x-large;">Press Enter to Submit</span>');
   // $("#msg_input").attr("placeholder", "");
    $(".bottom_wrapper").css({"padding": "0px 0px"});
    $("#msg_input").attr("onfocus", "hid();");
    $("#msg_input").attr("onblur", "vi();");
    $(".message_input_wrapper").css("width", "98%");
    $(".chat_window").css("width","100%");
    sp = document.getElementById('sp');

}


function hid(){
	sp.style.display = "none";
}
function vi(){
	if(!document.getElementById('msg_input').value){
		sp.style.display = "inline-block";
	}else{
		hid();
	}
}

var word =[]
function circularText(text) {
    word = [];
    let letter;
    for (var i=0; i<text.length; i++){
        letter = text.charAt(i);
        if (letter>='!' && letter<='Z' ){
            word.push(letter);
      
        }
    }
    console.log(word,'word');
    $("#0").prop("value",word[0]);
    $("#1").prop("value",word[1]);
    $("#2").prop("value",word[2]);
    $("#3").prop("value",word[3]);
    $("#4").prop("value",word[4]);
    $("#5").prop("value",word[5]);
}

function button_controls(input){
    var text = '';
    myKeyVals = {"text" : input}
    $.ajax({
      type: 'POST',
      url:  "/" + "input",
      data: myKeyVals,
      // dataType: 'json',
      
      success: function(response) {
          text = response['text'];
          circularText(response['word']);
          console.log(response['score']);
          if (text=='valid' || text=='invalid'){
              display_words(input,text); 
              $('#score').text(response['score']);   
          }
      }
      
        });
    

}

function display_words(input,response){
    console.log(input,response);
    if (response == "valid"){
      text = '<li>' + input + '</li>'
      $("#valid_list").append(text);
    }
    else{
      text = '<li>' + input + '</li>'
      $("#invalid_list").append(text);
    }
}

function new_button(){
  clear_button();
  $('#valid_list').empty();
  $('#invalid_list').empty();
  button_controls('/new');
}
function delete_button() {
  if  ($("#word_entered").text() != ""){
        console.log("not empty")
        let letter = $("#word_entered").text().slice(-1);
        let class_name ='#' + String(word.indexOf(letter));
        let new_word = $("#word_entered").text().slice(0,-1);
        $("#word_entered").text(new_word);
        
        $(class_name).prop('disabled',false);
  }
} 
function shuffle_button(){
  clear_button();
  button_controls('/shuffle');

}

function clear_button(){
  console.log('clear');
  $("#word_entered").text("");
  $("#0").prop("disabled",false);
  $("#1").prop("disabled",false);
  $("#2").prop("disabled",false);
  $("#3").prop("disabled",false);
  $("#4").prop("disabled",false);
  $("#5").prop("disabled",false);
}

function enter_button(){
  if ($("#word_entered").text() != ""){
    let word_entered = $("#word_entered").text();
    button_controls(word_entered);
    clear_button();
    
  }
  
}

function firstletter(){
    let exist = $("#word_entered").text() + word[0];
    $("#word_entered").text(exist);
    $("#0").prop('disabled',true);
}
function secondletter(){
    let exist = $("#word_entered").text() + word[5];
    $("#word_entered").text(exist);
    $("#5").prop('disabled',true);
}

function thirdletter(){
    let exist = $("#word_entered").text() + word[1];
    $("#word_entered").text(exist);
    $("#1").prop('disabled',true);
}

function fourthletter(){
    let exist = $("#word_entered").text() + word[4];
    $("#word_entered").text(exist);
    $("#4").prop('disabled',true);
}
function fiffthletter(){
    let exist = $("#word_entered").text() + word[2];
    $("#word_entered").text(exist);
    $("#2").prop('disabled',true);
}
function sixthletter(){
    let exist = $("#word_entered").text() + word[3];
    $("#word_entered").text(exist);
    $("#3").prop('disabled',true);
}


function capitalize(s)
{
  if (typeof s !== 'string')
  return '';
  return s.charAt(0).toUpperCase() + s.slice(1);
}

function getUrlParameter(sParam) {
    var sPageURL = window.location.search.substring(1),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
        }
    }
  }


  </script>
</html>
